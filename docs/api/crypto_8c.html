<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>globalplatform: crypto.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">globalplatform
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">crypto.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This implements all crypto functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="crypto_8h_source.html">crypto.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stringify_8h_source.html">globalplatform/stringify.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="errorcodes_8h_source.html">globalplatform/errorcodes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="error_8h_source.html">globalplatform/error.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="debug_8h_source.html">globalplatform/debug.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="util_8h_source.html">util.h</a>&quot;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;openssl/err.h&gt;</code><br />
<code>#include &lt;openssl/rand.h&gt;</code><br />
<code>#include &lt;openssl/evp.h&gt;</code><br />
<code>#include &lt;openssl/pem.h&gt;</code><br />
<code>#include &lt;openssl/aes.h&gt;</code><br />
<code>#include &lt;openssl/cmac.h&gt;</code><br />
<code>#include &lt;openssl/bn.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for crypto.c:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8c__incl.png" border="0" usemap="#crypto_8c" alt=""/></div>
<map name="crypto_8c" id="crypto_8c">
<area shape="rect" title="This implements all crypto functions." alt="" coords="1097,5,1166,32"/>
<area shape="rect" href="crypto_8h.html" title=" " alt="" coords="337,80,406,107"/>
<area shape="rect" href="error_8h.html" title=" " alt="" coords="584,155,727,181"/>
<area shape="rect" href="stringify_8h.html" title=" " alt="" coords="657,80,819,107"/>
<area shape="rect" href="errorcodes_8h.html" title=" " alt="" coords="843,80,1022,107"/>
<area shape="rect" href="debug_8h.html" title=" " alt="" coords="430,80,582,107"/>
<area shape="rect" href="util_8h.html" title=" " alt="" coords="262,80,313,107"/>
<area shape="rect" title=" " alt="" coords="1047,80,1112,107"/>
<area shape="rect" title=" " alt="" coords="1136,80,1233,107"/>
<area shape="rect" title=" " alt="" coords="1258,80,1365,107"/>
<area shape="rect" title=" " alt="" coords="1389,80,1490,107"/>
<area shape="rect" title=" " alt="" coords="1514,80,1621,107"/>
<area shape="rect" title=" " alt="" coords="1645,80,1748,107"/>
<area shape="rect" title=" " alt="" coords="1773,80,1887,107"/>
<area shape="rect" title=" " alt="" coords="1911,80,2007,107"/>
<area shape="rect" href="types_8h.html" title=" " alt="" coords="75,229,225,256"/>
<area shape="rect" href="library_8h.html" title=" " alt="" coords="306,155,458,181"/>
<area shape="rect" href="unicode_8h.html" title=" " alt="" coords="519,229,682,256"/>
<area shape="rect" href="security_8h.html" title=" " alt="" coords="69,155,231,181"/>
<area shape="rect" href="wintypes_8h.html" title="This keeps a list of Windows(R) types." alt="" coords="108,304,192,331"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab12490ca8a036ed7b8b1f84f851fd9f2"><td class="memItemLeft" align="right" valign="top"><a id="ab12490ca8a036ed7b8b1f84f851fd9f2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EVP_CIPHER_CTX_define</b>&#160;&#160;&#160;EVP_CIPHER_CTX *ctx;  EVP_CIPHER_CTX _ctx</td></tr>
<tr class="separator:ab12490ca8a036ed7b8b1f84f851fd9f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11c7f70c959a5614fabd62c1b1ece562"><td class="memItemLeft" align="right" valign="top"><a id="a11c7f70c959a5614fabd62c1b1ece562"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EVP_CIPHER_CTX_create</b>&#160;&#160;&#160;&amp;_ctx</td></tr>
<tr class="separator:a11c7f70c959a5614fabd62c1b1ece562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae63ef3cf01b103ef47d9ca4c31000f42"><td class="memItemLeft" align="right" valign="top"><a id="ae63ef3cf01b103ef47d9ca4c31000f42"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EVP_CIPHER_CTX_free</b>&#160;&#160;&#160;EVP_CIPHER_CTX_cleanup</td></tr>
<tr class="separator:ae63ef3cf01b103ef47d9ca4c31000f42"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae9b6dcc498dd05a6ecdeeaaff1405570"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ae9b6dcc498dd05a6ecdeeaaff1405570">calculate_enc_cbc</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, int messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *encryption, int *encryptionLength)</td></tr>
<tr class="separator:ae9b6dcc498dd05a6ecdeeaaff1405570"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a2846fdb8b3a0c3abddce3d40a975af"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a5a2846fdb8b3a0c3abddce3d40a975af">calculate_MAC_aes</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, int messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> mac[16])</td></tr>
<tr class="separator:a5a2846fdb8b3a0c3abddce3d40a975af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ef8782db5f69729c8768b9fc3c106de"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a8ef8782db5f69729c8768b9fc3c106de">calculate_cryptogram_SCP03</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], const <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> derivationConstant, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> context1, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> context1Length, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> context2, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> context2Length, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> cryptogram, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> cryptogramSize)</td></tr>
<tr class="separator:a8ef8782db5f69729c8768b9fc3c106de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51ebdbad71e62b7209677d331c11d6ea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a51ebdbad71e62b7209677d331c11d6ea">calculate_CMAC_aes</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sMacKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, int messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> chainingValue[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> mac[16])</td></tr>
<tr class="memdesc:a51ebdbad71e62b7209677d331c11d6ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a MAC for commands (APDUs) using CMAC AES. This is used by SCP03. The MAC for the message are the first 8 Bytes of mac. The next chainingValue are the full 16 Bytes of mac. Save this value for the next command MAC calculation.  <a href="crypto_8c.html#a51ebdbad71e62b7209677d331c11d6ea">More...</a><br /></td></tr>
<tr class="separator:a51ebdbad71e62b7209677d331c11d6ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87b912097d4cecb698f3b368c3c36adb"><td class="memItemLeft" align="right" valign="top"><a id="a87b912097d4cecb698f3b368c3c36adb"></a>
<a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><b>calculate_enc_ecb_SCP03</b> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, int messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *encryption, int *encryptionLength)</td></tr>
<tr class="separator:a87b912097d4cecb698f3b368c3c36adb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1c786ce98a6da06b3ac9d09c43be88a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ac1c786ce98a6da06b3ac9d09c43be88a">calculate_enc_cbc_SCP03_min_padding</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, int messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> icv[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *encryption, int *encryptionLength)</td></tr>
<tr class="separator:ac1c786ce98a6da06b3ac9d09c43be88a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b529f37da29e91f7e12ab75a856fc89"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a3b529f37da29e91f7e12ab75a856fc89">calculate_enc_cbc_SCP03</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, int messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> icv[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *encryption, int *encryptionLength)</td></tr>
<tr class="separator:a3b529f37da29e91f7e12ab75a856fc89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0966a1fda1ae028f1a4359cd158c14ad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a0966a1fda1ae028f1a4359cd158c14ad">calculate_dec_cbc_SCP03</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> icv[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *decryption, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> *decryptionLength)</td></tr>
<tr class="separator:a0966a1fda1ae028f1a4359cd158c14ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92371578429854f82fe2493913c0d2d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a92371578429854f82fe2493913c0d2d4">calculate_enc_icv_SCP03</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a2a3e0cda5f1249bef6db47c5eb8e3813">LONG</a> sessionEncryptionCounter, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *icv, BOOL forResponse)</td></tr>
<tr class="separator:a92371578429854f82fe2493913c0d2d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a580bef2e184c8eafa5a14193e16cfeaa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a580bef2e184c8eafa5a14193e16cfeaa">calculate_enc_cbc_SCP02</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, int messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *encryption, int *encryptionLength)</td></tr>
<tr class="separator:a580bef2e184c8eafa5a14193e16cfeaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48d36faa84ccc84f7fd72edfe19efa33"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a48d36faa84ccc84f7fd72edfe19efa33">calculate_card_cryptogram_SCP01</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> S_ENCSessionKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardCryptogram[8])</td></tr>
<tr class="separator:a48d36faa84ccc84f7fd72edfe19efa33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a420779aef546e376dfd26840f3f0de8f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a420779aef546e376dfd26840f3f0de8f">calculate_card_cryptogram_SCP02</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> S_ENCSessionKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sequenceCounter[2], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[6], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardCryptogram[8])</td></tr>
<tr class="separator:a420779aef546e376dfd26840f3f0de8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8d48774e9218300449e26f4f808c31f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#af8d48774e9218300449e26f4f808c31f">calculate_card_cryptogram_SCP03</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> S_MACSessionKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardCryptogram[8])</td></tr>
<tr class="separator:af8d48774e9218300449e26f4f808c31f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a018bd8a2e79b6f4200aa6535efdd1f8a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a018bd8a2e79b6f4200aa6535efdd1f8a">calculate_card_challenge_SCP03</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> S_ENC[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sequenceCounter[3], <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> invokingAID, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> invokingAIDLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[8])</td></tr>
<tr class="separator:a018bd8a2e79b6f4200aa6535efdd1f8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab80cbf5d1378a0f94255850238e5e9af"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ab80cbf5d1378a0f94255850238e5e9af">calculate_host_cryptogram_SCP01</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> S_ENCSessionKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostCryptogram[8])</td></tr>
<tr class="separator:ab80cbf5d1378a0f94255850238e5e9af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab00d951da646f5e04d4c89b9102e8320"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ab00d951da646f5e04d4c89b9102e8320">calculate_host_cryptogram_SCP02</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> S_ENCSessionKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sequenceCounter[2], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[6], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostCryptogram[8])</td></tr>
<tr class="separator:ab00d951da646f5e04d4c89b9102e8320"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76db282e496bc0c1bdd7b9c5393179cf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a76db282e496bc0c1bdd7b9c5393179cf">calculate_host_cryptogram_SCP03</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> S_MACSessionKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostCryptogram[8])</td></tr>
<tr class="separator:a76db282e496bc0c1bdd7b9c5393179cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4df004eacfa7fd68ecaf4fee028344de"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a4df004eacfa7fd68ecaf4fee028344de">create_session_key_SCP01</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sessionKey[16])</td></tr>
<tr class="separator:a4df004eacfa7fd68ecaf4fee028344de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe22eba8aa84d075177511c9899c97c6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#abe22eba8aa84d075177511c9899c97c6">create_session_key_SCP02</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> constant[2], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sequenceCounter[2], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sessionKey[16])</td></tr>
<tr class="separator:abe22eba8aa84d075177511c9899c97c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a175f4915ea599ed08a0152eca29aa4e8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a175f4915ea599ed08a0152eca29aa4e8">create_session_key_SCP03</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> derivationConstant, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sessionKey[16])</td></tr>
<tr class="separator:a175f4915ea599ed08a0152eca29aa4e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e7cb7178299bd250302ed7a6d9fc364"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a6e7cb7178299bd250302ed7a6d9fc364">calculate_enc_ecb_two_key_triple_des</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, int messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *encryption, int *encryptionLength)</td></tr>
<tr class="separator:a6e7cb7178299bd250302ed7a6d9fc364"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab397e4f6aa5a3dbb0f71bc649e19a617"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ab397e4f6aa5a3dbb0f71bc649e19a617">calculate_enc_ecb_single_des</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, int messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *encryption, int *encryptionLength)</td></tr>
<tr class="separator:ab397e4f6aa5a3dbb0f71bc649e19a617"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61cfa4ce2e419d65b26f2cd2f62beaa2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a61cfa4ce2e419d65b26f2cd2f62beaa2">calculate_MAC</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sessionKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, int messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> icv[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> mac[8])</td></tr>
<tr class="separator:a61cfa4ce2e419d65b26f2cd2f62beaa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54bc5c755e17b647b8da2f8401033bf9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a54bc5c755e17b647b8da2f8401033bf9">calculate_rsa_signature</a> (<a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> message, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> messageLength, <a class="el" href="types_8h.html#a88d56175458160f0a49ab97a45681f1f">OPGP_STRING</a> PEMKeyFileName, char *passPhrase, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> signature[128])</td></tr>
<tr class="separator:a54bc5c755e17b647b8da2f8401033bf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67d846afa18213adc8098831a0254f14"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a67d846afa18213adc8098831a0254f14">calculate_MAC_des_3des</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> _3des_key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, int messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> initialICV[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> mac[8])</td></tr>
<tr class="separator:a67d846afa18213adc8098831a0254f14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a134bf78fcb303d7175535fdba3dbce62"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a134bf78fcb303d7175535fdba3dbce62">validate_receipt</a> (<a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> validationData, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> validationDataLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> receipt[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> receiptKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> secureChannelProtocol)</td></tr>
<tr class="separator:a134bf78fcb303d7175535fdba3dbce62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa54e61360338db48720119471b79e283"><td class="memItemLeft" align="right" valign="top"><a id="aa54e61360338db48720119471b79e283"></a>
<a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><b>validate_delete_receipt</b> (<a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> confirmationCounter, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> cardUniqueData, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> cardUniqueDataLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> receiptKey[16], <a class="el" href="structGP211__RECEIPT__DATA.html">GP211_RECEIPT_DATA</a> receiptData, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> AID, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> AIDLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> secureChannelProtocol)</td></tr>
<tr class="separator:aa54e61360338db48720119471b79e283"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafcbeafbf202c2e965953d79d520a7ed"><td class="memItemLeft" align="right" valign="top"><a id="aafcbeafbf202c2e965953d79d520a7ed"></a>
<a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><b>get_key_data_field</b> (<a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> *secInfo, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> keyData, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> keyDataLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> keyType, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> isSensitive, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> keyDataField, <a class="el" href="types_8h.html#a5275a4ecdc7e43cac83633d4df04bb88">PDWORD</a> keyDataFieldLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> keyCheckValue[3])</td></tr>
<tr class="separator:aafcbeafbf202c2e965953d79d520a7ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38c3d27fe84c4f09597aca125d90eef7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a38c3d27fe84c4f09597aca125d90eef7">wrap_command</a> (<a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> apduCommand, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> apduCommandLength, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> wrappedApduCommand, <a class="el" href="types_8h.html#a5275a4ecdc7e43cac83633d4df04bb88">PDWORD</a> wrappedApduCommandLength, <a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> *secInfo)</td></tr>
<tr class="memdesc:a38c3d27fe84c4f09597aca125d90eef7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wraps a command, i.e. encrypts and add the MAC to the APDU with the necessary security information according to secInfo.  <a href="crypto_8c.html#a38c3d27fe84c4f09597aca125d90eef7">More...</a><br /></td></tr>
<tr class="separator:a38c3d27fe84c4f09597aca125d90eef7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f9d1bba86febfb01f7ccaf3e89072c1"><td class="memItemLeft" align="right" valign="top"><a id="a8f9d1bba86febfb01f7ccaf3e89072c1"></a>
<a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><b>validate_install_receipt</b> (<a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> confirmationCounter, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> cardUniqueData, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> cardUniqueDataLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> receiptKey[16], <a class="el" href="structGP211__RECEIPT__DATA.html">GP211_RECEIPT_DATA</a> receiptData, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> executableLoadFileAID, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> executableLoadFileAIDLength, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> applicationAID, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> applicationAIDLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> secureChannelProtocol)</td></tr>
<tr class="separator:a8f9d1bba86febfb01f7ccaf3e89072c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1522bd0dda6730d5ea0c5175ffe9f719"><td class="memItemLeft" align="right" valign="top"><a id="a1522bd0dda6730d5ea0c5175ffe9f719"></a>
<a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><b>validate_load_receipt</b> (<a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> confirmationCounter, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> cardUniqueData, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> cardUniqueDataLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> receiptKey[16], <a class="el" href="structGP211__RECEIPT__DATA.html">GP211_RECEIPT_DATA</a> receiptData, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> executableLoadFileAID, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> executableLoadFileAIDLength, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> securityDomainAID, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> securityDomainAIDLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> secureChannelProtocol)</td></tr>
<tr class="separator:a1522bd0dda6730d5ea0c5175ffe9f719"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad49c7dddc46faf4d31c018c3423d0a53"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ad49c7dddc46faf4d31c018c3423d0a53">GP211_calculate_R_MAC</a> (<a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> apduCommand, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> apduCommandLength, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> responseApdu, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> responseApduLength, <a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> *secInfo, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> mac[8])</td></tr>
<tr class="memdesc:ad49c7dddc46faf4d31c018c3423d0a53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a R-MAC.  <a href="crypto_8c.html#ad49c7dddc46faf4d31c018c3423d0a53">More...</a><br /></td></tr>
<tr class="separator:ad49c7dddc46faf4d31c018c3423d0a53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89ff6443fc1c818098cd4f63acb93d98"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a89ff6443fc1c818098cd4f63acb93d98">unwrap_command</a> (<a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> apduCommand, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> apduCommandLength, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> responseApdu, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> responseApduLength, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> unwrappedResponseApdu, <a class="el" href="types_8h.html#a5275a4ecdc7e43cac83633d4df04bb88">PDWORD</a> unwrappedResponseApduLength, <a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> *secInfo)</td></tr>
<tr class="memdesc:a89ff6443fc1c818098cd4f63acb93d98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unwraps a response, i.e. decrypts and checks the R-MAC of a response APDU with the necessary security information according to secInfo.  <a href="crypto_8c.html#a89ff6443fc1c818098cd4f63acb93d98">More...</a><br /></td></tr>
<tr class="separator:a89ff6443fc1c818098cd4f63acb93d98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a0df0005371806ef6edd2428c3477bf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a7a0df0005371806ef6edd2428c3477bf">GP211_check_R_MAC</a> (<a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> apduCommand, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> apduCommandLength, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> responseApdu, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> responseApduLength, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> unwrappedResponseApdu, <a class="el" href="types_8h.html#a5275a4ecdc7e43cac83633d4df04bb88">PDWORD</a> unwrappedResponseApduLength, <a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> *secInfo)</td></tr>
<tr class="memdesc:a7a0df0005371806ef6edd2428c3477bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks the R-MAC of an APDU with the necessary security information according to secInfo.  <a href="crypto_8c.html#a7a0df0005371806ef6edd2428c3477bf">More...</a><br /></td></tr>
<tr class="separator:a7a0df0005371806ef6edd2428c3477bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeac1ddaf07053bab3eb000ce45cbc334"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aeac1ddaf07053bab3eb000ce45cbc334">read_public_rsa_key</a> (<a class="el" href="types_8h.html#a88d56175458160f0a49ab97a45681f1f">OPGP_STRING</a> PEMKeyFileName, char *passPhrase, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> rsaModulus[128], <a class="el" href="types_8h.html#a2a3e0cda5f1249bef6db47c5eb8e3813">LONG</a> *rsaExponent)</td></tr>
<tr class="memdesc:aeac1ddaf07053bab3eb000ce45cbc334"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads a public RSA key from a file.  <a href="crypto_8c.html#aeac1ddaf07053bab3eb000ce45cbc334">More...</a><br /></td></tr>
<tr class="separator:aeac1ddaf07053bab3eb000ce45cbc334"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad646febaa4c4ffff1932e918058198af"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ad646febaa4c4ffff1932e918058198af">calculate_hash</a> (<a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> message, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hash[32], const EVP_MD *md)</td></tr>
<tr class="separator:ad646febaa4c4ffff1932e918058198af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd697d8dc25e87e07b425c56c0daef59"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#acd697d8dc25e87e07b425c56c0daef59">calculate_sha256_hash</a> (<a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> message, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hash[32])</td></tr>
<tr class="memdesc:acd697d8dc25e87e07b425c56c0daef59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a SHA-256 hash.  <a href="crypto_8c.html#acd697d8dc25e87e07b425c56c0daef59">More...</a><br /></td></tr>
<tr class="separator:acd697d8dc25e87e07b425c56c0daef59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af81486a2108254e015938c6b86452db5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#af81486a2108254e015938c6b86452db5">calculate_sha1_hash</a> (<a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> message, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hash[20])</td></tr>
<tr class="memdesc:af81486a2108254e015938c6b86452db5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a SHA-1 hash.  <a href="crypto_8c.html#af81486a2108254e015938c6b86452db5">More...</a><br /></td></tr>
<tr class="separator:af81486a2108254e015938c6b86452db5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a774d37720da1ff656dadb187c8df21f5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a774d37720da1ff656dadb187c8df21f5">calculate_MAC_right_des_3des</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, int messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> mac[8])</td></tr>
<tr class="memdesc:a774d37720da1ff656dadb187c8df21f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a MAC using first DES and 3DES for the final round when the padding is applied.  <a href="crypto_8c.html#a774d37720da1ff656dadb187c8df21f5">More...</a><br /></td></tr>
<tr class="separator:a774d37720da1ff656dadb187c8df21f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9d715ebbffb154159958e17ce589a32"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ac9d715ebbffb154159958e17ce589a32">get_random</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *random, int randomLength)</td></tr>
<tr class="separator:ac9d715ebbffb154159958e17ce589a32"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This implements all crypto functions. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a018bd8a2e79b6f4200aa6535efdd1f8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a018bd8a2e79b6f4200aa6535efdd1f8a">&#9670;&nbsp;</a></span>calculate_card_challenge_SCP03()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_card_challenge_SCP03 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>S_ENC</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sequenceCounter</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>invokingAID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>invokingAIDLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the card challenge when using pseudo-random challenge generation for SCP03. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">S_ENC</td><td>[in] The static S-ENC Key. </td></tr>
    <tr><td class="paramname">sequenceCounter</td><td>[in] The sequence counter. </td></tr>
    <tr><td class="paramname">invokingAID</td><td>The invoking AID byte buffer. </td></tr>
    <tr><td class="paramname">invokingAIDLength</td><td>The length of the invoking AID byte buffer. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[out] The calculated challenge. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a48d36faa84ccc84f7fd72edfe19efa33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48d36faa84ccc84f7fd72edfe19efa33">&#9670;&nbsp;</a></span>calculate_card_cryptogram_SCP01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_card_cryptogram_SCP01 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>S_ENCSessionKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardCryptogram</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the card cryptogram for SCP01. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">S_ENCSessionKey</td><td>[in] The S-ENC Session Key for calculating the card cryptogram. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[in] The card challenge. </td></tr>
    <tr><td class="paramname">hostChallenge</td><td>[in] The host challenge. </td></tr>
    <tr><td class="paramname">cardCryptogram</td><td>[out] The calculated card cryptogram. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a420779aef546e376dfd26840f3f0de8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a420779aef546e376dfd26840f3f0de8f">&#9670;&nbsp;</a></span>calculate_card_cryptogram_SCP02()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_card_cryptogram_SCP02 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>S_ENCSessionKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sequenceCounter</em>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[6], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardCryptogram</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the card cryptogram for SCP02. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">S_ENCSessionKey</td><td>[in] The S-ENC Session Key for calculating the card cryptogram. </td></tr>
    <tr><td class="paramname">sequenceCounter</td><td>[in] The sequence counter. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[in] The card challenge. </td></tr>
    <tr><td class="paramname">hostChallenge</td><td>[in] The host challenge. </td></tr>
    <tr><td class="paramname">cardCryptogram</td><td>[out] The calculated card cryptogram. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="af8d48774e9218300449e26f4f808c31f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8d48774e9218300449e26f4f808c31f">&#9670;&nbsp;</a></span>calculate_card_cryptogram_SCP03()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_card_cryptogram_SCP03 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>S_MACSessionKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardCryptogram</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the card cryptogram for SCP03. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">S_MACSessionKey</td><td>[in] The S-MAC Session Key for calculating the card cryptogram. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[in] The card challenge. </td></tr>
    <tr><td class="paramname">hostChallenge</td><td>[in] The host challenge. </td></tr>
    <tr><td class="paramname">cardCryptogram</td><td>[out] The calculated host cryptogram. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a51ebdbad71e62b7209677d331c11d6ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51ebdbad71e62b7209677d331c11d6ea">&#9670;&nbsp;</a></span>calculate_CMAC_aes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_CMAC_aes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sMacKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>chainingValue</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>mac</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a MAC for commands (APDUs) using CMAC AES. This is used by SCP03. The MAC for the message are the first 8 Bytes of mac. The next chainingValue are the full 16 Bytes of mac. Save this value for the next command MAC calculation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sMacKey</td><td>[in] The S-MAC key (session MAC key) to use for MAC generation. </td></tr>
    <tr><td class="paramname">message</td><td>[in] The message to generate the MAC for. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The length of the message. </td></tr>
    <tr><td class="paramname">chainingValue</td><td>[in] The chaining value to use for the MAC generation. This is usually the full 16 Byte MAC generated for the last command or 16 bytes 0x00 for the first one (i.e. EXTERNAL AUTHENTICATE). </td></tr>
    <tr><td class="paramname">mac</td><td>[out] The full 16 Byte MAC. Append the first 8 Bytes to the message. Save the full 16 Bytes for further MAC generation if needed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8ef8782db5f69729c8768b9fc3c106de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ef8782db5f69729c8768b9fc3c106de">&#9670;&nbsp;</a></span>calculate_cryptogram_SCP03()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_cryptogram_SCP03 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>derivationConstant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>context1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>context1Length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>context2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>context2Length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>cryptogram</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>cryptogramSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the a cryptogram for multiple SCP03 operation like host cryptogram, card cryptogram and card challenge calculation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The AES key to use for the calculation. </td></tr>
    <tr><td class="paramname">derivationConstant</td><td>The derivation constant for the key derivation function. </td></tr>
    <tr><td class="paramname">context1</td><td>The context1 for the internal key derivation. </td></tr>
    <tr><td class="paramname">context1Length</td><td>The length of the context1 buffer. </td></tr>
    <tr><td class="paramname">context2</td><td>The context2 for the internal key derivation. </td></tr>
    <tr><td class="paramname">context2Length</td><td>The length of the context3 buffer. </td></tr>
    <tr><td class="paramname">cryptogram</td><td>[out] The calculated cryptogram. Must be large enough to hold the result. For session keys this is 128 bits, 64 bits otherwise. </td></tr>
    <tr><td class="paramname">cryptogramSize</td><td>[in] The result size in bits of the cryptogram. Must be a multiple of 8. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a0966a1fda1ae028f1a4359cd158c14ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0966a1fda1ae028f1a4359cd158c14ad">&#9670;&nbsp;</a></span>calculate_dec_cbc_SCP03()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_dec_cbc_SCP03 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>icv</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>decryption</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> *&#160;</td>
          <td class="paramname"><em>decryptionLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the decryption of a message in CBC mode for SCP03 using AES. Pads the message with 0x80 and additional 0x00 until message length is a multiple of 16. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] An AES key used to decrypt. </td></tr>
    <tr><td class="paramname">*message</td><td>[in] The message to decrypt. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The length of the message. </td></tr>
    <tr><td class="paramname">icv</td><td>[in] The ICV to use. </td></tr>
    <tr><td class="paramname">*decryption</td><td>[out] The encryption. </td></tr>
    <tr><td class="paramname">*decryptionLength</td><td>[out] The length of the encryption. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="ae9b6dcc498dd05a6ecdeeaaff1405570"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9b6dcc498dd05a6ecdeeaaff1405570">&#9670;&nbsp;</a></span>calculate_enc_cbc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_enc_cbc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>encryption</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>encryptionLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the encryption of a message in CBC mode. Pads the message with 0x80 and additional 0x00 if message length is not a multiple of 8. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] A 3DES key used to encrypt. </td></tr>
    <tr><td class="paramname">*message</td><td>[in] The message to encrypt. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The length of the message. </td></tr>
    <tr><td class="paramname">*encryption</td><td>[out] The encryption. </td></tr>
    <tr><td class="paramname">*encryptionLength</td><td>[out] The length of the encryption. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a580bef2e184c8eafa5a14193e16cfeaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a580bef2e184c8eafa5a14193e16cfeaa">&#9670;&nbsp;</a></span>calculate_enc_cbc_SCP02()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_enc_cbc_SCP02 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>encryption</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>encryptionLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the encryption of a message in CBC mode for SCP02. Pads the message with 0x80 and additional 0x00 until message length is a multiple of 8. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] A 3DES key used to encrypt. </td></tr>
    <tr><td class="paramname">*message</td><td>[in] The message to encrypt. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The length of the message. </td></tr>
    <tr><td class="paramname">*encryption</td><td>[out] The encryption. </td></tr>
    <tr><td class="paramname">*encryptionLength</td><td>[out] The length of the encryption. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a3b529f37da29e91f7e12ab75a856fc89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b529f37da29e91f7e12ab75a856fc89">&#9670;&nbsp;</a></span>calculate_enc_cbc_SCP03()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_enc_cbc_SCP03 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>icv</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>encryption</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>encryptionLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the encryption of a message in CBC mode for SCP03 using AES. Pads the message with 0x80 and additional 0x00 until message length is a multiple of 16. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] An AES key used to encrypt. </td></tr>
    <tr><td class="paramname">*message</td><td>[in] The message to encrypt. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The length of the message. </td></tr>
    <tr><td class="paramname">icv</td><td>[in] The ICV to use. </td></tr>
    <tr><td class="paramname">*encryption</td><td>[out] The encryption. </td></tr>
    <tr><td class="paramname">*encryptionLength</td><td>[out] The length of the encryption. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="ac1c786ce98a6da06b3ac9d09c43be88a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1c786ce98a6da06b3ac9d09c43be88a">&#9670;&nbsp;</a></span>calculate_enc_cbc_SCP03_min_padding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_enc_cbc_SCP03_min_padding </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>icv</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>encryption</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>encryptionLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the encryption of a message in CBC mode for SCP03 using AES with no padding if not needed. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] An AES key used to encrypt. </td></tr>
    <tr><td class="paramname">*message</td><td>[in] The message to encrypt. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The length of the message. </td></tr>
    <tr><td class="paramname">icv</td><td>[in] The ICV to use. </td></tr>
    <tr><td class="paramname">*encryption</td><td>[out] The encryption. </td></tr>
    <tr><td class="paramname">*encryptionLength</td><td>[out] The length of the encryption. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="ab397e4f6aa5a3dbb0f71bc649e19a617"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab397e4f6aa5a3dbb0f71bc649e19a617">&#9670;&nbsp;</a></span>calculate_enc_ecb_single_des()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_enc_ecb_single_des </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>encryption</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>encryptionLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the encryption of a message in ECB mode with single DES. Pads the message with 0x80 and additional 0x00 if message length is not a multiple of 8. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] A DES key used to encrypt. </td></tr>
    <tr><td class="paramname">*message</td><td>[in] The message to encrypt. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The length of the message. </td></tr>
    <tr><td class="paramname">*encryption</td><td>[out] The encryption. </td></tr>
    <tr><td class="paramname">*encryptionLength</td><td>[out] The length of the encryption. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a6e7cb7178299bd250302ed7a6d9fc364"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e7cb7178299bd250302ed7a6d9fc364">&#9670;&nbsp;</a></span>calculate_enc_ecb_two_key_triple_des()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_enc_ecb_two_key_triple_des </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>encryption</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>encryptionLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the encryption of a message in ECB mode with two key triple DES. Pads the message with 0x80 and additional 0x00 if message length is not a multiple of 8. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] A 3DES key used to encrypt. </td></tr>
    <tr><td class="paramname">*message</td><td>[in] The message to encrypt. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The length of the message. </td></tr>
    <tr><td class="paramname">*encryption</td><td>[out] The encryption. </td></tr>
    <tr><td class="paramname">*encryptionLength</td><td>[out] The length of the encryption. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STALTUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a92371578429854f82fe2493913c0d2d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92371578429854f82fe2493913c0d2d4">&#9670;&nbsp;</a></span>calculate_enc_icv_SCP03()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_enc_icv_SCP03 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a2a3e0cda5f1249bef6db47c5eb8e3813">LONG</a>&#160;</td>
          <td class="paramname"><em>sessionEncryptionCounter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>icv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BOOL&#160;</td>
          <td class="paramname"><em>forResponse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the encryption ICV for SCP03 using AES. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] An AES key used to encrypt. </td></tr>
    <tr><td class="paramname">sessionEncryptionCounter</td><td>[in] The session encryption counter. </td></tr>
    <tr><td class="paramname">*icv</td><td>[out] The ICV to use. </td></tr>
    <tr><td class="paramname">forResponse</td><td>1 if the calculation is performed for the response. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="ad646febaa4c4ffff1932e918058198af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad646febaa4c4ffff1932e918058198af">&#9670;&nbsp;</a></span>calculate_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hash</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const EVP_MD *&#160;</td>
          <td class="paramname"><em>md</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>[in] The message to generate the hash for. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The length of the message buffer. </td></tr>
    <tr><td class="paramname">hash</td><td>[out] The calculated hash. </td></tr>
    <tr><td class="paramname">md</td><td>[in] The message digest to use. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab80cbf5d1378a0f94255850238e5e9af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab80cbf5d1378a0f94255850238e5e9af">&#9670;&nbsp;</a></span>calculate_host_cryptogram_SCP01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_host_cryptogram_SCP01 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>S_ENCSessionKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostCryptogram</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the host cryptogram for SCP01. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">S_ENCSessionKey</td><td>[in] The S-ENC Session Key for calculating the card cryptogram. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[in] The card challenge. </td></tr>
    <tr><td class="paramname">hostChallenge</td><td>[in] The host challenge. </td></tr>
    <tr><td class="paramname">hostCryptogram</td><td>[out] The calculated host cryptogram. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="ab00d951da646f5e04d4c89b9102e8320"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab00d951da646f5e04d4c89b9102e8320">&#9670;&nbsp;</a></span>calculate_host_cryptogram_SCP02()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_host_cryptogram_SCP02 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>S_ENCSessionKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sequenceCounter</em>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[6], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostCryptogram</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the host cryptogram for SCP02. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">S_ENCSessionKey</td><td>[in] The S-ENC Session Key for calculating the card cryptogram. </td></tr>
    <tr><td class="paramname">sequenceCounter</td><td>[in] The sequence counter. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[in] The card challenge. </td></tr>
    <tr><td class="paramname">hostChallenge</td><td>[in] The host challenge. </td></tr>
    <tr><td class="paramname">hostCryptogram</td><td>[out] The calculated host cryptogram. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a76db282e496bc0c1bdd7b9c5393179cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76db282e496bc0c1bdd7b9c5393179cf">&#9670;&nbsp;</a></span>calculate_host_cryptogram_SCP03()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_host_cryptogram_SCP03 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>S_MACSessionKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostCryptogram</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the host cryptogram for SCP03. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">S_MACSessionKey</td><td>[in] The S-MAC Session Key for calculating the card cryptogram. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[in] The card challenge. </td></tr>
    <tr><td class="paramname">hostChallenge</td><td>[in] The host challenge. </td></tr>
    <tr><td class="paramname">hostCryptogram</td><td>[out] The calculated host cryptogram. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a61cfa4ce2e419d65b26f2cd2f62beaa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61cfa4ce2e419d65b26f2cd2f62beaa2">&#9670;&nbsp;</a></span>calculate_MAC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_MAC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sessionKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>icv</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>mac</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates a message authentication code. Pads the message always with 0x80 and additional 0x00 until message length is a multiple of 8. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sessionKey</td><td>[in] A 3DES key used to sign. </td></tr>
    <tr><td class="paramname">*message</td><td>[in] The message to authenticate. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The message length. </td></tr>
    <tr><td class="paramname">icv</td><td>[in] The initial chaining vector. </td></tr>
    <tr><td class="paramname">mac</td><td>[out] The calculated MAC. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a5a2846fdb8b3a0c3abddce3d40a975af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a2846fdb8b3a0c3abddce3d40a975af">&#9670;&nbsp;</a></span>calculate_MAC_aes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_MAC_aes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>mac</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates a message authentication code, using AES-128 in CBC mode. This is the algorithm specified in NIST 800-38B. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] The AES-128 key to use. </td></tr>
    <tr><td class="paramname">*message</td><td>[in] The message to calculate the MAC for. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The message length. </td></tr>
    <tr><td class="paramname">mac</td><td>[out] The calculated MAC. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a67d846afa18213adc8098831a0254f14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67d846afa18213adc8098831a0254f14">&#9670;&nbsp;</a></span>calculate_MAC_des_3des()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_MAC_des_3des </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>_3des_key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>initialICV</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>mac</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates a message authentication code using the left half key of a two key 3DES key and the the full key for the final operation. Pads the message always with 0x80 and additional 0x00 until message length is a multiple of 8. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_3des_key</td><td>[in] A 3DES key used to sign. </td></tr>
    <tr><td class="paramname">*message</td><td>[in] The message to authenticate. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The message length. </td></tr>
    <tr><td class="paramname">initialICV</td><td>[in] The initial chaining vector. </td></tr>
    <tr><td class="paramname">mac</td><td>[out] The calculated MAC. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a774d37720da1ff656dadb187c8df21f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a774d37720da1ff656dadb187c8df21f5">&#9670;&nbsp;</a></span>calculate_MAC_right_des_3des()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_MAC_right_des_3des </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>mac</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a MAC using first DES and 3DES for the final round when the padding is applied. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] A 3DES key used to sign. For DES the right half of the key is used. </td></tr>
    <tr><td class="paramname">*message</td><td>[in] The message to authenticate. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The message length. </td></tr>
    <tr><td class="paramname">mac</td><td>[out] The calculated MAC. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a54bc5c755e17b647b8da2f8401033bf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54bc5c755e17b647b8da2f8401033bf9">&#9670;&nbsp;</a></span>calculate_rsa_signature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_rsa_signature </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a88d56175458160f0a49ab97a45681f1f">OPGP_STRING</a>&#160;</td>
          <td class="paramname"><em>PEMKeyFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>passPhrase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>signature</em>[128]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates a RSA signature using SHA-1 and PKCS#1. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>[in] The message to generate the signature for. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The length of the message buffer. </td></tr>
    <tr><td class="paramname">PEMKeyFileName</td><td>[in] A PEM file name with the private RSA key. </td></tr>
    <tr><td class="paramname">*passPhrase</td><td>[in] The passphrase. Must be an ASCII string. </td></tr>
    <tr><td class="paramname">signature</td><td>The calculated signature. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af81486a2108254e015938c6b86452db5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af81486a2108254e015938c6b86452db5">&#9670;&nbsp;</a></span>calculate_sha1_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_sha1_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hash</em>[20]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a SHA-1 hash. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>[in] The message to generate the hash for. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The length of the message buffer. </td></tr>
    <tr><td class="paramname">hash</td><td>[out] The calculated hash. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acd697d8dc25e87e07b425c56c0daef59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd697d8dc25e87e07b425c56c0daef59">&#9670;&nbsp;</a></span>calculate_sha256_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_sha256_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hash</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a SHA-256 hash. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>[in] The message to generate the hash for. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The length of the message buffer. </td></tr>
    <tr><td class="paramname">hash</td><td>[out] The calculated hash. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4df004eacfa7fd68ecaf4fee028344de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4df004eacfa7fd68ecaf4fee028344de">&#9670;&nbsp;</a></span>create_session_key_SCP01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> create_session_key_SCP01 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sessionKey</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates the session key for SCP01. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] The Secure Channel Encryption Key or Secure Channel Message Authentication Code Key for calculating the corresponding session key. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[in] The card challenge. </td></tr>
    <tr><td class="paramname">hostChallenge</td><td>[in] The host challenge. </td></tr>
    <tr><td class="paramname">sessionKey</td><td>[out] The calculated 3DES session key. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="abe22eba8aa84d075177511c9899c97c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe22eba8aa84d075177511c9899c97c6">&#9670;&nbsp;</a></span>create_session_key_SCP02()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> create_session_key_SCP02 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>constant</em>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sequenceCounter</em>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sessionKey</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates the session key for SCP02. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] The Secure Channel Encryption Key or Secure Channel Message Authentication Code Key or Data Encryption Key for calculating the corresponding session key. </td></tr>
    <tr><td class="paramname">constant</td><td>[in] The constant for the corresponding session key. </td></tr>
    <tr><td class="paramname">sequenceCounter</td><td>[in] The sequence counter. </td></tr>
    <tr><td class="paramname">sessionKey</td><td>[out] The calculated 3DES session key. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a175f4915ea599ed08a0152eca29aa4e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a175f4915ea599ed08a0152eca29aa4e8">&#9670;&nbsp;</a></span>create_session_key_SCP03()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> create_session_key_SCP03 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>derivationConstant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sessionKey</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates an AES-128 session key for SCP03. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] The Secure Channel Encryption Key or Secure Channel Message Authentication Code Key for calculating the corresponding session key. </td></tr>
    <tr><td class="paramname">derivationConstant</td><td>[in] The derivation constant, as defined in "Table 4-1: Data derivation constants" of SCP03. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[in] The card challenge. </td></tr>
    <tr><td class="paramname">hostChallenge</td><td>[in] The host challenge. </td></tr>
    <tr><td class="paramname">sessionKey</td><td>[out] The calculated AES session key. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="ac9d715ebbffb154159958e17ce589a32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9d715ebbffb154159958e17ce589a32">&#9670;&nbsp;</a></span>get_random()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> get_random </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>randomLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*random</td><td>[out] The random to generate. </td></tr>
    <tr><td class="paramname">randomLength</td><td>[in] The random length to generate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="ad49c7dddc46faf4d31c018c3423d0a53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad49c7dddc46faf4d31c018c3423d0a53">&#9670;&nbsp;</a></span>GP211_calculate_R_MAC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> GP211_calculate_R_MAC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>apduCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>apduCommandLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>responseApdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>responseApduLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> *&#160;</td>
          <td class="paramname"><em>secInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>mac</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a R-MAC. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">apduCommand</td><td>[in] The APDU command. </td></tr>
    <tr><td class="paramname">apduCommandLength</td><td>[in] The APDU command length. </td></tr>
    <tr><td class="paramname">responseApdu</td><td>[in] The APDU response APDU. </td></tr>
    <tr><td class="paramname">responseApduLength</td><td>[in] The APDU response APDU length. </td></tr>
    <tr><td class="paramname">*secInfo</td><td>[in] The pointer to the <a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> structure returned by <a class="el" href="globalplatform_8h.html#a04ec0caaa3d78ae71bde0843f626b2ca" title="GlobalPlatform2.1.1: Mutual authentication.">GP211_mutual_authentication()</a>. </td></tr>
    <tr><td class="paramname">mac</td><td>[out] The R-MAC. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a7a0df0005371806ef6edd2428c3477bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a0df0005371806ef6edd2428c3477bf">&#9670;&nbsp;</a></span>GP211_check_R_MAC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> GP211_check_R_MAC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>apduCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>apduCommandLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>responseApdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>responseApduLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>unwrappedResponseApdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a5275a4ecdc7e43cac83633d4df04bb88">PDWORD</a>&#160;</td>
          <td class="paramname"><em>unwrappedResponseApduLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> *&#160;</td>
          <td class="paramname"><em>secInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks the R-MAC of an APDU with the necessary security information according to secInfo. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">apduCommand</td><td>[in] The command APDU. </td></tr>
    <tr><td class="paramname">apduCommandLength</td><td>[in] The length of the command APDU. </td></tr>
    <tr><td class="paramname">responseApdu</td><td>[in] The response APDU. </td></tr>
    <tr><td class="paramname">responseApduLength</td><td>[in] The length of the response APDU. </td></tr>
    <tr><td class="paramname">unwrappedResponseApdu</td><td>[out] The buffer for the unwrapped response APDU. </td></tr>
    <tr><td class="paramname">unwrappedResponseApduLength</td><td>[in, out] The available and returned modified length of the unwrappedResponseAPDU buffer. </td></tr>
    <tr><td class="paramname">*secInfo</td><td>[in] The pointer to the <a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> structure returned by <a class="el" href="globalplatform_8h.html#a04ec0caaa3d78ae71bde0843f626b2ca" title="GlobalPlatform2.1.1: Mutual authentication.">GP211_mutual_authentication()</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="aeac1ddaf07053bab3eb000ce45cbc334"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeac1ddaf07053bab3eb000ce45cbc334">&#9670;&nbsp;</a></span>read_public_rsa_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> read_public_rsa_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a88d56175458160f0a49ab97a45681f1f">OPGP_STRING</a>&#160;</td>
          <td class="paramname"><em>PEMKeyFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>passPhrase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>rsaModulus</em>[128], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a2a3e0cda5f1249bef6db47c5eb8e3813">LONG</a> *&#160;</td>
          <td class="paramname"><em>rsaExponent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads a public RSA key from a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PEMKeyFileName</td><td>[in] The key file. </td></tr>
    <tr><td class="paramname">*passPhrase</td><td>[in] The passphrase. Must be an ASCII string. </td></tr>
    <tr><td class="paramname">rsaModulus</td><td>[out] The RSA modulus. </td></tr>
    <tr><td class="paramname">rsaExponent</td><td>[out] The RSA exponent. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a89ff6443fc1c818098cd4f63acb93d98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89ff6443fc1c818098cd4f63acb93d98">&#9670;&nbsp;</a></span>unwrap_command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> unwrap_command </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>apduCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>apduCommandLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>responseApdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>responseApduLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>unwrappedResponseApdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a5275a4ecdc7e43cac83633d4df04bb88">PDWORD</a>&#160;</td>
          <td class="paramname"><em>unwrappedResponseApduLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> *&#160;</td>
          <td class="paramname"><em>secInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unwraps a response, i.e. decrypts and checks the R-MAC of a response APDU with the necessary security information according to secInfo. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">apduCommand</td><td>[in] The command APDU. </td></tr>
    <tr><td class="paramname">apduCommandLength</td><td>[in] The length of the command APDU. </td></tr>
    <tr><td class="paramname">responseApdu</td><td>[in] The response data. </td></tr>
    <tr><td class="paramname">responseApduLength</td><td>[in] The length of the response data. </td></tr>
    <tr><td class="paramname">unwrappedResponseApdu</td><td>[out] The buffer for the unwrapped response APDU. </td></tr>
    <tr><td class="paramname">unwrappedResponseApduLength</td><td>[in, out] The available and returned modified length of the unwrappedResponseAPDU buffer. </td></tr>
    <tr><td class="paramname">*secInfo</td><td>[in] The pointer to the <a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> structure returned by <a class="el" href="globalplatform_8h.html#a04ec0caaa3d78ae71bde0843f626b2ca" title="GlobalPlatform2.1.1: Mutual authentication.">GP211_mutual_authentication()</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a134bf78fcb303d7175535fdba3dbce62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a134bf78fcb303d7175535fdba3dbce62">&#9670;&nbsp;</a></span>validate_receipt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> validate_receipt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>validationData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>validationDataLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>receipt</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>receiptKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>secureChannelProtocol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>GlobalPlatform2.1.1: Validates a Receipt. Returns OPGP_ERROR_STATUS_SUCCESS if the receipt is valid. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">validationData</td><td>[in] The data used to validate the returned receipt. </td></tr>
    <tr><td class="paramname">validationDataLength</td><td>[in] The length of the validationData buffer. </td></tr>
    <tr><td class="paramname">receipt</td><td>[in] The receipt. </td></tr>
    <tr><td class="paramname">receiptKey</td><td>[in] The 3DES key to generate the receipt. </td></tr>
    <tr><td class="paramname">secureChannelProtocol</td><td>[in] The Secure Channel Protocol. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a38c3d27fe84c4f09597aca125d90eef7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38c3d27fe84c4f09597aca125d90eef7">&#9670;&nbsp;</a></span>wrap_command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> wrap_command </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>apduCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>apduCommandLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>wrappedApduCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a5275a4ecdc7e43cac83633d4df04bb88">PDWORD</a>&#160;</td>
          <td class="paramname"><em>wrappedApduCommandLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> *&#160;</td>
          <td class="paramname"><em>secInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wraps a command, i.e. encrypts and add the MAC to the APDU with the necessary security information according to secInfo. </p>
<p>Wraps a APDU with the necessary security information according to secInfo. The wrappedapduCommand must be a buffer with enough space for the potential added padding for the encryption and the MAC. The maximum possible extra space to the apduCommandLength is 8 bytes for the MAC plus 7 bytes for padding and one Lc byte in the encryption process. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">apduCommand</td><td>[in] The command APDU. </td></tr>
    <tr><td class="paramname">apduCommandLength</td><td>[in] The length of the command APDU. </td></tr>
    <tr><td class="paramname">wrappedApduCommand</td><td>[out] The buffer for the wrapped APDU command. </td></tr>
    <tr><td class="paramname">wrappedApduCommandLength</td><td>[in, out] The available and returned modified length of the wrappedApduCommand buffer. </td></tr>
    <tr><td class="paramname">*secInfo</td><td>[in] The pointer to the <a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> structure returned by <a class="el" href="globalplatform_8h.html#a04ec0caaa3d78ae71bde0843f626b2ca" title="GlobalPlatform2.1.1: Mutual authentication.">GP211_mutual_authentication()</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
